"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{4205:function(e,t,r){r.d(t,{Ff:function(){return U},Iq:function(){return P},vp:function(){return k},$D:function(){return L}});var n=r(6717),s=r(7387),a=r(1842),i=r(4010),o=r(3439),l=r(2085),c=r(1310),d=r(6057),x=r(8941),u=r(5354),y=r(7091),h=r(5530),m=r(1386),p=r(812);let g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;return new Promise(t=>setTimeout(t,e))},j=[{content:"安全生产管理的方针是什么？",options:[{key:"A",text:"安全第一，预防为主，综合治理"},{key:"B",text:"安全第一，生产第二"},{key:"C",text:"预防为主，综合治理"},{key:"D",text:"安全第一，质量第一"}],score:2,type:"single",correctAnswer:"A",analysis:'安全生产管理的方针是"安全第一，预防为主，综合治理"。'},{content:'下列哪项不属于安全生产"三同时"原则？',options:[{key:"A",text:"同时设计"},{key:"B",text:"同时施工"},{key:"C",text:"同时投入生产和使用"},{key:"D",text:"同时验收"}],score:2,type:"single",correctAnswer:"D",analysis:'安全生产"三同时"原则是指建设项目安全设施必须与主体工程同时设计、同时施工、同时投入生产和使用。'},{content:"危险化学品储存的基本要求是什么？",options:[{key:"A",text:"分类储存，标识清楚"},{key:"B",text:"随意堆放"},{key:"C",text:"混合储存"},{key:"D",text:"露天储存"}],score:2,type:"single",correctAnswer:"A",analysis:"危险化学品必须分类储存，标识清楚，严禁混合储存和随意堆放。"},{content:"发生火灾时，正确的逃生方法是？",options:[{key:"A",text:"乘坐电梯"},{key:"B",text:"用湿毛巾捂住口鼻，低姿逃生"},{key:"C",text:"跳楼逃生"},{key:"D",text:"躲在床下"}],score:2,type:"single",correctAnswer:"B",analysis:"发生火灾时，应使用湿毛巾捂住口鼻，低姿逃生，切勿乘坐电梯或跳楼。"},{content:"个人防护用品（PPE）的作用是什么？",options:[{key:"A",text:"装饰作用"},{key:"B",text:"保护劳动者免受职业危害"},{key:"C",text:"提高工作效率"},{key:"D",text:"降低生产成本"}],score:2,type:"single",correctAnswer:"B",analysis:"个人防护用品的主要作用是保护劳动者免受职业危害，是最后一道防线。"},{content:"下列哪些属于安全生产责任制的内容？",options:[{key:"A",text:"企业主要负责人对本单位安全生产工作全面负责"},{key:"B",text:"分管负责人对分管范围内的安全生产工作负责"},{key:"C",text:"从业人员对本岗位安全生产工作负责"},{key:"D",text:"安全生产责任制与工资无关"}],score:3,type:"multiple",correctAnswer:["A","B","C"],analysis:"安全生产责任制要求企业主要负责人、分管负责人和从业人员都要承担相应的安全生产责任。"},{content:"危险作业包括哪些？",options:[{key:"A",text:"高处作业"},{key:"B",text:"动火作业"},{key:"C",text:"有限空间作业"},{key:"D",text:"办公室作业"}],score:3,type:"multiple",correctAnswer:["A","B","C"],analysis:"危险作业包括高处作业、动火作业、有限空间作业等，需要特殊的安全措施和审批。"},{content:"事故应急救援的基本原则包括？",options:[{key:"A",text:"统一指挥"},{key:"B",text:"分级负责"},{key:"C",text:"属地为主"},{key:"D",text:"各自为政"}],score:3,type:"multiple",correctAnswer:["A","B","C"],analysis:"事故应急救援应遵循统一指挥、分级负责、属地为主的原则。"},{content:"安全生产教育培训的对象包括？",options:[{key:"A",text:"新入职员工"},{key:"B",text:"转岗员工"},{key:"C",text:"在岗员工"},{key:"D",text:"管理人员"}],score:3,type:"multiple",correctAnswer:["A","B","C","D"],analysis:"安全生产教育培训应覆盖所有从业人员，包括新入职、转岗、在岗员工和管理人员。"},{content:"职业健康监护包括哪些内容？",options:[{key:"A",text:"上岗前健康检查"},{key:"B",text:"在岗期间定期健康检查"},{key:"C",text:"离岗时健康检查"},{key:"D",text:"应急健康检查"}],score:3,type:"multiple",correctAnswer:["A","B","C","D"],analysis:"职业健康监护包括上岗前、在岗期间、离岗时和应急健康检查。"},{content:"安全生产事故是可以完全避免的。",options:[{key:"A",text:"正确"},{key:"B",text:"错误"}],score:1,type:"judge",correctAnswer:"B",analysis:"虽然可以通过预防措施大幅降低事故发生率，但完全避免所有事故是不现实的。"},{content:"安全帽只要没有破损就可以一直使用。",options:[{key:"A",text:"正确"},{key:"B",text:"错误"}],score:1,type:"judge",correctAnswer:"B",analysis:"安全帽有使用期限，即使没有破损，超过使用期限也应更换。"},{content:"危险化学品可以与其他物品混放。",options:[{key:"A",text:"正确"},{key:"B",text:"错误"}],score:1,type:"judge",correctAnswer:"B",analysis:"危险化学品必须分类储存，严禁与其他物品混放，以免发生化学反应。"},{content:"从业人员有权拒绝违章指挥和强令冒险作业。",options:[{key:"A",text:"正确"},{key:"B",text:"错误"}],score:1,type:"judge",correctAnswer:"A",analysis:"从业人员有权拒绝违章指挥和强令冒险作业，这是法律赋予的权利。"},{content:"安全生产标准化是自愿性的。",options:[{key:"A",text:"正确"},{key:"B",text:"错误"}],score:1,type:"judge",correctAnswer:"B",analysis:"安全生产标准化是强制性的，企业必须按照标准要求进行安全生产管理。"},{content:"应急预案应当定期进行演练。",options:[{key:"A",text:"正确"},{key:"B",text:"错误"}],score:1,type:"judge",correctAnswer:"A",analysis:"应急预案应当定期进行演练，以检验预案的有效性和可操作性。"},{content:'安全设施"三同时"是指什么？',options:[{key:"A",text:"同时设计、同时施工、同时验收"},{key:"B",text:"同时设计、同时施工、同时投入生产和使用"},{key:"C",text:"同时规划、同时建设、同时使用"},{key:"D",text:"同时设计、同时建设、同时验收"}],score:2,type:"single",correctAnswer:"B",analysis:'安全设施"三同时"是指同时设计、同时施工、同时投入生产和使用。'}],f=[{id:"1",name:"安全生产基础知识考核",examTime:"2025-01-15 09:00:00",duration:90,questionCount:50,fullScore:100,passingScore:80,status:"notStarted",isOpen:!0,trainingCompleted:!0},{id:"2",name:"危险化学品安全管理考核",examTime:"2025-01-20 14:00:00",duration:120,questionCount:60,fullScore:100,passingScore:85,status:"notStarted",isOpen:!0,trainingCompleted:!0},{id:"3",name:"职业健康与防护考核",examTime:"2025-01-10 10:00:00",duration:60,questionCount:40,fullScore:100,passingScore:75,status:"passed",isOpen:!0,trainingCompleted:!0,score:92,actualDuration:"45分30秒"},{id:"4",name:"应急管理与救援考核",examTime:"2025-01-05 09:00:00",duration:90,questionCount:50,fullScore:100,passingScore:80,status:"failed",isOpen:!0,trainingCompleted:!0,score:65,actualDuration:"88分15秒"},{id:"5",name:"消防安全知识考核",examTime:"2024-12-20 09:00:00",duration:60,questionCount:40,fullScore:100,passingScore:75,status:"expired",isOpen:!1,trainingCompleted:!1}];async function Z(e){await g(500);let t=[...f];return e&&"all"!==e&&(t=f.filter(t=>t.status===e)),{code:200,data:t}}async function b(e){await g(300);let t=f.find(t=>t.id===e);return t?{code:200,data:{id:t.id,name:t.name,duration:t.duration,questionCount:t.questionCount,fullScore:t.fullScore,passingScore:t.passingScore,examTimeDisplay:t.examTimeDisplay||t.examTime,status:t.status}}:{code:404,data:{id:e,name:"考核计划",duration:90,questionCount:50,fullScore:100,passingScore:80,status:"notStarted"}}}async function S(e){await g(500);let t=localStorage.getItem("questions_".concat(e));if(t)try{let e=JSON.parse(t);if(Array.isArray(e)&&e.length>0)return{code:200,data:e}}catch(e){}let r=f.find(t=>t.id===e),n=function(e){let t=function(e){let t=[...e];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}(j);return t.slice(0,Math.min(e,t.length)).map((e,t)=>({...e,id:"q_".concat(Date.now(),"_").concat(t),questionId:"q_".concat(Date.now(),"_").concat(t),questionOrder:t+1}))}((null==r?void 0:r.questionCount)||50);return localStorage.setItem("questions_".concat(e),JSON.stringify(n)),{code:200,data:n}}async function v(e,t,r){await g(100);let n="answers_".concat(e),s=JSON.parse(localStorage.getItem(n)||"{}");return s[t]=r,localStorage.setItem(n,JSON.stringify(s)),{code:200,message:"答案已保存"}}async function C(e){await g(1e3);let{examPlanId:t,answers:r,duration:n}=e,s=f.find(e=>e.id===t);if(!s)return{code:404,data:null};let a=[],i=localStorage.getItem("questions_".concat(t));if(i)try{let e=JSON.parse(i);Array.isArray(e)&&(a=e)}catch(e){}0===a.length&&(a=(await S(t)).data);let o=0,l=0,c=0,d=[];a.forEach(e=>{var t;let n=(null===(t=r.find(t=>t.questionId===e.id))||void 0===t?void 0:t.option)||"",s=e.correctAnswer,a=!1;if("multiple"===e.type){let e=n.split(",").filter(Boolean).sort(),t=Array.isArray(s)?[...s].sort():[s].filter(Boolean).sort();a=e.length===t.length&&e.every(e=>t.includes(e))}else a=String(n)===String(s);n?a?(o+=e.score,l++,d.push({questionId:e.id,status:"correct"})):(c++,d.push({questionId:e.id,status:"wrong"})):d.push({questionId:e.id,status:"unanswered"})});let x=a.length,u=x-l-c,y=x>0?Math.round(l/x*100):0,h=o>=s.passingScore,m=e=>{let t=e=>e.toString().padStart(2,"0");return"".concat(t(Math.floor(e/3600)),":").concat(t(Math.floor(e%3600/60)),":").concat(t(e%60))},p={examPlanId:t,name:s.name,score:o,scoreText:"".concat(o,"分"),status:h?"PASSED":"FAILED",isPassed:h,correctCount:l,totalCount:x,correctCountDisplay:"".concat(l,"/").concat(x),wrongCount:c,unansweredCount:u,accuracy:y,duration:m(n),timeUsed:m(n),questions:a.map(e=>{var t;let n=(null===(t=r.find(t=>t.questionId===e.id))||void 0===t?void 0:t.option)||"",s=e.correctAnswer,a="UNANSWERED";if(n){if("multiple"===e.type){let e=n.split(",").filter(Boolean).sort(),t=Array.isArray(s)?[...s].sort():[s].filter(Boolean).sort();a=e.length===t.length&&e.every(e=>t.includes(e))?"CORRECT":"WRONG"}else a=String(n)===String(s)?"CORRECT":"WRONG"}return{...e,userAnswer:n,answerStatus:a}}),answerSheet:d};return localStorage.setItem("result_".concat(t),JSON.stringify(p)),localStorage.removeItem("answers_".concat(t)),localStorage.removeItem("questions_".concat(t)),{code:200,data:p}}async function w(e){await g(300);let t=localStorage.getItem("result_".concat(e));if(t)return{code:200,data:JSON.parse(t)};let r=f.find(t=>t.id===e);if(!r)throw Error("考核不存在");return{code:200,data:{examPlanId:e,name:r.name,score:0,scoreText:"0分",status:"FAILED",isPassed:!1,correctCount:0,totalCount:0,correctCountDisplay:"0/0",wrongCount:0,unansweredCount:0,accuracy:0,duration:"00:00:00",timeUsed:"00:00:00",questions:[],answerSheet:[]}}}function k(e){let{onOpenExam:t,onOpenResult:r}=e,[g,j]=(0,s.useState)("notStarted"),[f,b]=(0,s.useState)(""),[S,v]=(0,s.useState)([]),[C,w]=(0,s.useState)(!0),[k,A]=(0,s.useState)(null);(0,s.useEffect)(()=>{I()},[g]);let I=async()=>{try{w(!0),A(null);let e=await Z(g);200===e.code?v(e.data):A("加载考核列表失败")}catch(e){A("加载考核列表失败"),console.error(e)}finally{w(!1)}},B=e=>{if("expired"===e.status){alert("考核已过期");return}if("notStarted"===e.status){if(!e.trainingCompleted){alert("请先完成培训学习，再来参加考试。");return}if(!e.isOpen){alert("考核未开放");return}null==t||t(e.id)}else null==r||r(e.id)},D=S.filter(e=>e.name.includes(f));return(0,n.jsxs)(a.Z,{sx:{maxWidth:1200,mx:"auto"},children:[(0,n.jsx)(i.Z,{variant:"h4",gutterBottom:!0,sx:{mb:3,mt:3},children:"用户考核管理"}),(0,n.jsx)(a.Z,{sx:{mb:3},children:(0,n.jsx)(o.Z,{fullWidth:!0,placeholder:"请输入考核计划名称",value:f,onChange:e=>{b(e.target.value)},InputProps:{startAdornment:(0,n.jsx)(p.Z,{sx:{mr:1,color:"text.secondary"}})}})}),(0,n.jsx)(a.Z,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,n.jsxs)(l.Z,{value:g,onChange:(e,t)=>{j(t),b("")},children:[(0,n.jsx)(c.Z,{label:"未开始",value:"notStarted"}),(0,n.jsx)(c.Z,{label:"通过",value:"passed"}),(0,n.jsx)(c.Z,{label:"未通过",value:"failed"}),(0,n.jsx)(c.Z,{label:"已过期",value:"expired"})]})}),C&&(0,n.jsx)(a.Z,{sx:{display:"flex",justifyContent:"center",py:4},children:(0,n.jsx)(d.Z,{})}),k&&(0,n.jsx)(x.Z,{severity:"error",sx:{mb:2},children:k}),!C&&!k&&(0,n.jsx)(n.Fragment,{children:0===D.length?(0,n.jsx)(a.Z,{sx:{textAlign:"center",py:4},children:(0,n.jsx)(i.Z,{color:"text.secondary",children:"暂无数据"})}):(0,n.jsx)(a.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:D.map(e=>(0,n.jsx)(u.Z,{sx:{cursor:"pointer","&:hover":{boxShadow:4},transition:"box-shadow 0.3s"},onClick:()=>B(e),children:(0,n.jsx)(y.Z,{children:(0,n.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,n.jsxs)(a.Z,{sx:{flex:1},children:["failed"===g&&"failed"===e.status||"expired"===g&&"expired"===e.status?(0,n.jsx)(h.Z,{label:"failed"===e.status?"未通过":"已过期",color:"failed"===e.status?"error":"default",size:"small",sx:{mb:1}}):null,(0,n.jsx)(i.Z,{variant:"h6",gutterBottom:!0,children:e.name}),"failed"===g&&(0,n.jsxs)(a.Z,{sx:{mt:1},children:[(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["考试时间: ",e.examTime]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["实际用时: ",e.actualDuration||""]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["满分: ",e.fullScore,"分"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["及格分: ",e.passingScore,"分"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"error",sx:{mt:.5,fontWeight:"bold"},children:["实际得分: ",e.score||e.actualScore||"0","分"]})]}),"expired"===g&&(0,n.jsxs)(a.Z,{sx:{mt:1},children:[(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["考试时间: ",e.examTime]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["考试时长: ",e.duration,"分钟"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["题目数: ",e.questionCount,"题"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["满分: ",e.fullScore,"分"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["及格分: ",e.passingScore,"分"]})]}),"passed"===g&&(0,n.jsxs)(a.Z,{sx:{mt:1},children:[(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["考试时间: ",e.examTime]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["实际用时: ",e.actualDuration||"-"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["满分: ",e.fullScore,"分"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["及格分: ",e.passingScore,"分"]}),void 0!==e.score&&(0,n.jsxs)(i.Z,{variant:"body2",color:"primary",sx:{mt:.5,fontWeight:"bold"},children:["得分: ",e.score,"分"]})]}),"notStarted"===g&&(0,n.jsxs)(a.Z,{sx:{mt:1},children:[(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["考试时间: ",e.examTime]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["考试时长: ",e.duration,"分钟"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["题目数: ",e.questionCount,"题"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["满分: ",e.fullScore,"分"]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["及格分: ",e.passingScore,"分"]})]})]}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:["passed"===g&&"passed"===e.status&&e.certificateId&&(0,n.jsx)(m.Z,{variant:"outlined",size:"small",onClick:e=>{e.stopPropagation(),alert("查看证书功能待实现")},children:"查看证书"}),"notStarted"===e.status&&e.trainingCompleted&&e.isOpen&&(0,n.jsx)(i.Z,{sx:{fontSize:"1.5rem",color:"text.secondary"},children:">"}),"notStarted"===g&&"notStarted"===e.status&&(!e.trainingCompleted||!e.isOpen)&&(0,n.jsx)(h.Z,{label:"未开放",size:"small",color:"default"})]})]})})},e.id))})})]})}var A=r(5747),I=r(5660),B=r(8973),D=r(858),q=r(7663),_=r(7233),O=r(5696),R=r(4371),T=r(2489),E=r(2639),N=r(8836),W=r(992),z=r(8158);function P(e){let t,{assessmentId:r,onGoResult:o,onGoAnswerSheet:l}=e,[c,p]=(0,s.useState)(null),[g,j]=(0,s.useState)([]),[f,Z]=(0,s.useState)(0),[w,k]=(0,s.useState)({}),[P,J]=(0,s.useState)(0),[M,F]=(0,s.useState)(!1),[L,Q]=(0,s.useState)(!1),[U,G]=(0,s.useState)(!0),[H,$]=(0,s.useState)(null),K=(0,s.useRef)(null);(0,s.useEffect)(()=>(r&&V(),()=>{K.current&&clearInterval(K.current)}),[r]);let V=async()=>{if(r)try{G(!0),$(null),localStorage.removeItem("answers_".concat(r)),localStorage.removeItem("questions_".concat(r)),localStorage.removeItem("currentQuestionIndex_".concat(r));let[e,t]=await Promise.all([b(r),S(r)]);if(200===e.code&&200===t.code){p(e.data),j(t.data),localStorage.setItem("questions_".concat(r),JSON.stringify(t.data));let n=60*e.data.duration;J(n);let s=localStorage.getItem("answers_".concat(r));s&&k(JSON.parse(s)),X(n)}else $("加载考核数据失败")}catch(e){$("加载考核数据失败"),console.error(e)}finally{G(!1)}},X=e=>{K.current&&clearInterval(K.current),K.current=setInterval(()=>{J(e=>e<=0?(K.current&&clearInterval(K.current),en(),0):e-1)},1e3)};(0,s.useEffect)(()=>{if(!r||0===g.length)return;let e=()=>{if(!localStorage.getItem("answerSheetReturn_".concat(r)))return;let e=localStorage.getItem("currentQuestionIndex_".concat(r));if(null!=e){let t=Math.max(0,Math.min(parseInt(e,10)||0,g.length-1));Number.isFinite(t)&&t>=0&&t<g.length&&(Z(t),localStorage.removeItem("currentQuestionIndex_".concat(r)),localStorage.removeItem("answerSheetReturn_".concat(r)))}};e();let t=()=>{"visible"===document.visibilityState&&e()};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}},[r,g.length]);let Y=(e,t,n)=>{let s={...w,[e]:t};k(s),localStorage.setItem("answers_".concat(r),JSON.stringify(s)),"multiple"===n?v(r,e,Array.isArray(t)?t.join(","):t):v(r,e,String(t))},ee=(e,t)=>{Y(e,t,"single")},et=(e,t,r)=>{let n=w[e]||[],s=Array.isArray(n)?[...n]:[];if(r)s.includes(t)||s.push(t);else{let e=s.indexOf(t);e>-1&&s.splice(e,1)}Y(e,s,"multiple")},er=()=>{F(!1)},en=async()=>{if(r)try{Q(!0),F(!1),K.current&&clearInterval(K.current);let e=g.map(e=>{let t=w[e.id];return!t||""===t||Array.isArray(t)&&0===t.length?null:{questionId:e.id,option:Array.isArray(t)?t.join(","):String(t)}}).filter(e=>null!==e),t=(null==c?void 0:c.duration)||0,n=await C({examPlanId:r,answers:e,duration:Math.max(0,60*t-P)});200===n.code?(localStorage.removeItem("answers_".concat(r)),null==o||o(r)):(alert("提交失败，请重试"),Q(!1))}catch(e){console.error("提交考试失败",e),alert("提交失败"),Q(!1)}},es=g[f],ea=(t=0,g.forEach(e=>{let r=w[e.id];(!r||""===r||Array.isArray(r)&&0===r.length)&&t++}),t);return U?(0,n.jsx)(a.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,n.jsx)(d.Z,{})}):H?(0,n.jsx)(a.Z,{sx:{maxWidth:800,mx:"auto",mt:4},children:(0,n.jsx)(x.Z,{severity:"error",children:H})}):c&&0!==g.length?(0,n.jsxs)(a.Z,{sx:{maxWidth:1e3,mx:"auto"},children:[(0,n.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,p:2,bgcolor:"background.paper",borderRadius:1,boxShadow:1},children:[(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,n.jsx)(i.Z,{variant:"h6",children:c.name}),(0,n.jsx)(h.Z,{label:(null==es?void 0:es.type)==="multiple"?"多选题":"单选题",color:"primary",size:"small"})]}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,n.jsxs)(i.Z,{variant:"body1",color:"error",children:["⏰ ","".concat(Math.floor(P/60).toString().padStart(2,"0"),":").concat((P%60).toString().padStart(2,"0"))]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:[f+1,"/",g.length," (共",g.length,"题)"]}),(0,n.jsx)(A.Z,{onClick:()=>null==l?void 0:l(r,f),size:"small","aria-label":"answer-sheet",children:(0,n.jsx)(z.Z,{})})]})]}),es&&(0,n.jsx)(u.Z,{sx:{mb:3},children:(0,n.jsxs)(y.Z,{children:[(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"flex-start",mb:2},children:[(0,n.jsxs)(i.Z,{variant:"h6",sx:{flex:1},children:[f+1,". ",es.content]}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["(",es.score,"分)"]})]}),("single"===es.type||"judge"===es.type)&&(0,n.jsx)(I.Z,{value:w[es.id]||"",onChange:e=>ee(es.id,e.target.value),children:es.options.map(e=>(0,n.jsx)(B.Z,{value:e.key,control:(0,n.jsx)(D.Z,{}),label:"".concat(e.key,". ").concat(e.text),sx:{mb:1,p:1,borderRadius:1,"&:hover":{bgcolor:"action.hover"}}},e.key))}),"multiple"===es.type&&(0,n.jsx)(q.Z,{children:es.options.map(e=>{let t=w[es.id]||[],r=!!Array.isArray(t)&&t.includes(e.key);return(0,n.jsx)(B.Z,{control:(0,n.jsx)(_.Z,{checked:r,onChange:t=>et(es.id,e.key,t.target.checked)}),label:"".concat(e.key,". ").concat(e.text),sx:{mb:1,p:1,borderRadius:1,"&:hover":{bgcolor:"action.hover"}}},e.key)})})]})}),(0,n.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-between",gap:2},children:[(0,n.jsx)(m.Z,{variant:"outlined",startIcon:(0,n.jsx)(N.Z,{}),onClick:()=>{f>0&&Z(f-1)},disabled:0===f,children:"上一题"}),(0,n.jsx)(m.Z,{variant:"contained",endIcon:f===g.length-1?null:(0,n.jsx)(W.Z,{}),onClick:f===g.length-1?()=>{F(!0)}:()=>{f<g.length-1&&Z(f+1)},disabled:L,children:f===g.length-1?"提交":"下一题"})]}),(0,n.jsxs)(O.Z,{open:M,onClose:er,maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(R.Z,{children:"操作提示"}),(0,n.jsx)(T.Z,{children:(0,n.jsxs)(a.Z,{sx:{textAlign:"center",py:2},children:[(0,n.jsx)(i.Z,{variant:"h4",sx:{mb:2},children:"✓"}),(0,n.jsx)(i.Z,{variant:"body1",children:0===ea?"试题已做完,确认提交吗?":"您有".concat(ea,"题未作答,确认提交吗?")})]})}),(0,n.jsxs)(E.Z,{children:[(0,n.jsx)(m.Z,{onClick:er,disabled:L,children:"再看看"}),(0,n.jsx)(m.Z,{onClick:en,variant:"contained",disabled:L,children:L?(0,n.jsx)(d.Z,{size:20}):"确认提交"})]})]})]}):(0,n.jsx)(a.Z,{sx:{maxWidth:800,mx:"auto",mt:4},children:(0,n.jsx)(x.Z,{severity:"warning",children:"考核数据不存在"})})}var J=r(92),M=r(5770),F=r(7226);function L(e){let{assessmentId:t,onBackToList:r,onViewWrongQuestions:o,onViewQuestionAnalysis:l}=e,[c,p]=(0,s.useState)(null),[g,j]=(0,s.useState)(!0),[f,Z]=(0,s.useState)(null);(0,s.useEffect)(()=>{t&&b()},[t]);let b=async()=>{if(t)try{j(!0),Z(null);let e=await w(t);200===e.code?p(e.data):Z("加载考核结果失败")}catch(e){Z("加载考核结果失败"),console.error(e)}finally{j(!1)}},S=e=>{if(l)return l(t,e);alert("查看题目解析功能待实现")};return g?(0,n.jsx)(a.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,n.jsx)(d.Z,{})}):f?(0,n.jsx)(a.Z,{sx:{maxWidth:800,mx:"auto",mt:4},children:(0,n.jsx)(x.Z,{severity:"error",children:f})}):c?(0,n.jsxs)(a.Z,{sx:{maxWidth:1e3,mx:"auto"},children:[(0,n.jsx)(i.Z,{variant:"h4",gutterBottom:!0,sx:{mb:3},children:"考核结果"}),(0,n.jsx)(u.Z,{sx:{mb:3},children:(0,n.jsxs)(y.Z,{children:[(0,n.jsxs)(a.Z,{sx:{textAlign:"center",mb:3},children:[(0,n.jsx)(a.Z,{sx:{width:120,height:120,borderRadius:"50%",border:"4px solid",borderColor:c.isPassed?"success.main":"error.main",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:(0,n.jsxs)(i.Z,{variant:"h4",color:c.isPassed?"success.main":"error.main",children:[c.accuracy,"%"]})}),(0,n.jsx)(i.Z,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"正确率"})]}),(0,n.jsxs)(a.Z,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(3, 1fr)"},gap:2,mb:2},children:[(0,n.jsxs)(J.Z,{sx:{p:2,textAlign:"center"},children:[(0,n.jsx)(i.Z,{variant:"h6",color:"primary",children:"⭐"}),(0,n.jsx)(i.Z,{variant:"body2",color:"text.secondary",children:"答对数"}),(0,n.jsx)(i.Z,{variant:"h6",children:c.correctCountDisplay})]}),(0,n.jsxs)(J.Z,{sx:{p:2,textAlign:"center"},children:[(0,n.jsx)(i.Z,{variant:"h6",color:"primary",children:"⏰"}),(0,n.jsx)(i.Z,{variant:"body2",color:"text.secondary",children:"用时"}),(0,n.jsx)(i.Z,{variant:"h6",children:c.timeUsed})]}),(0,n.jsxs)(J.Z,{sx:{p:2,textAlign:"center"},children:[(0,n.jsx)(i.Z,{variant:"h6",color:"primary",children:"\uD83C\uDFC6"}),(0,n.jsx)(i.Z,{variant:"body2",color:"text.secondary",children:"得分"}),(0,n.jsx)(i.Z,{variant:"h6",children:c.scoreText})]})]}),c.isPassed?(0,n.jsx)(h.Z,{icon:(0,n.jsx)(M.Z,{}),label:"已通过",color:"success",sx:{fontSize:"1rem",py:2.5}}):(0,n.jsx)(h.Z,{icon:(0,n.jsx)(F.Z,{}),label:"未通过",color:"error",sx:{fontSize:"1rem",py:2.5}})]})}),c.wrongCount>0&&(0,n.jsx)(u.Z,{sx:{mb:3,cursor:"pointer","&:hover":{boxShadow:4},transition:"box-shadow 0.3s"},onClick:()=>{if(!c||0===c.wrongCount){alert("暂无错题");return}if(o)return o(t);alert("查看错题功能待实现")},children:(0,n.jsx)(y.Z,{children:(0,n.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,n.jsx)(i.Z,{variant:"h6",color:"error",children:"❌"}),(0,n.jsxs)(a.Z,{children:[(0,n.jsx)(i.Z,{variant:"h6",children:"本次错题"}),(0,n.jsxs)(i.Z,{variant:"body2",color:"text.secondary",children:["共有 ",c.wrongCount," 道错题，点击查看"]})]})]}),(0,n.jsx)(i.Z,{sx:{fontSize:"1.5rem",color:"text.secondary"},children:">"})]})})}),c.answerSheet&&c.answerSheet.length>0&&(0,n.jsx)(u.Z,{children:(0,n.jsxs)(y.Z,{children:[(0,n.jsx)(i.Z,{variant:"h6",gutterBottom:!0,children:"答题卡"}),(0,n.jsxs)(a.Z,{sx:{display:"flex",gap:2,mb:2},children:[(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(a.Z,{sx:{width:20,height:20,borderRadius:"50%",bgcolor:"success.main"}}),(0,n.jsx)(i.Z,{variant:"body2",children:"答对"})]}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(a.Z,{sx:{width:20,height:20,borderRadius:"50%",bgcolor:"error.main"}}),(0,n.jsx)(i.Z,{variant:"body2",children:"答错"})]}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(a.Z,{sx:{width:20,height:20,borderRadius:"50%",bgcolor:"grey.400"}}),(0,n.jsx)(i.Z,{variant:"body2",children:"未答"})]})]}),(0,n.jsx)(a.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(50px, 1fr))",gap:1},children:c.answerSheet.map((e,t)=>{let r="correct"===e.status?"success.main":"wrong"===e.status?"error.main":"grey.400",s="unanswered"===e.status?"text.primary":"white";return(0,n.jsx)(a.Z,{onClick:()=>S(t),sx:{width:50,height:50,borderRadius:1,bgcolor:r,color:s,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer","&:hover":{opacity:.8}},children:(0,n.jsx)(i.Z,{variant:"body2",fontWeight:"bold",children:t+1})},e.questionId)})})]})}),(0,n.jsx)(a.Z,{sx:{mt:3,textAlign:"center"},children:(0,n.jsx)(m.Z,{variant:"contained",onClick:()=>r?r():void 0,children:"返回考核列表"})})]}):(0,n.jsx)(a.Z,{sx:{maxWidth:800,mx:"auto",mt:4},children:(0,n.jsx)(x.Z,{severity:"warning",children:"考核结果不存在"})})}function Q(e,t,r){let n=null==e?void 0:e[String(t)];if(null==n||""===n)return!1;if("multiple"===r){if(Array.isArray(n))return n.length>0;if("string"==typeof n){let e=n.trim();return""!==e&&"null"!==e&&"undefined"!==e}return!1}if("string"==typeof n){let e=n.trim();return""!==e&&"null"!==e&&"undefined"!==e}return!0}function U(e){let{assessmentId:t,currentIndex:r,onBack:o,onGoExam:l}=e,[c,d]=(0,s.useState)([]),[x,m]=(0,s.useState)({});(0,s.useEffect)(()=>{if(!t)return;let e=JSON.parse(localStorage.getItem("questions_".concat(t))||"[]"),r=JSON.parse(localStorage.getItem("answers_".concat(t))||"{}");d((Array.isArray(e)?e:[]).map(e=>({...e,id:String(e.id)}))),m(r&&"object"==typeof r?r:{})},[t]);let p=(0,s.useMemo)(()=>c.reduce((e,t)=>e+(Q(x,t.id,t.type)?1:0),0),[x,c]),g=e=>{t&&(localStorage.setItem("currentQuestionIndex_".concat(t),String(e)),localStorage.setItem("answerSheetReturn_".concat(t),Date.now().toString()),null==l||l(t))};return(0,n.jsxs)(a.Z,{sx:{maxWidth:900,mx:"auto"},children:[(0,n.jsx)(u.Z,{sx:{mb:2},children:(0,n.jsxs)(y.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:2},children:[(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(A.Z,{onClick:()=>o?o():void 0,size:"small","aria-label":"back",children:(0,n.jsx)(N.Z,{})}),(0,n.jsx)(i.Z,{variant:"h6",children:"答题卡"})]}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[(0,n.jsx)(h.Z,{size:"small",label:"已完成 ".concat(p,"/").concat(c.length),color:"primary"}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(a.Z,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:"grey.300"}}),(0,n.jsx)(i.Z,{variant:"body2",color:"text.secondary",children:"未完成"})]}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(a.Z,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:"primary.main"}}),(0,n.jsx)(i.Z,{variant:"body2",color:"text.secondary",children:"已完成"})]})]})]})}),(0,n.jsx)(u.Z,{children:(0,n.jsx)(y.Z,{children:(0,n.jsx)(a.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(56px, 1fr))",gap:1.5},children:c.map((e,t)=>{let s=Q(x,e.id,e.type);return(0,n.jsx)(a.Z,{onClick:()=>g(t),sx:{width:56,height:56,borderRadius:"50%",mx:"auto",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",bgcolor:s?"primary.main":"grey.200",color:s?"primary.contrastText":"text.primary",border:t===r?"2px solid":"2px solid transparent",borderColor:t===r?"error.main":"transparent",boxSizing:"border-box","&:hover":{opacity:.9}},children:(0,n.jsx)(i.Z,{variant:"body2",fontWeight:"bold",children:t+1})},e.id)})})})})]})}}}]);